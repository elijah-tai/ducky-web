<script src="//maps.google.com/maps/api/js?v=3.13&amp;sensor=false&amp;libraries=geometry" type="text/javascript"></script>
<script src='//google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.14/src/markerclusterer_packed.js' type='text/javascript'></script>
<div class="row">
	<div class="col-md-offset-2 col-md-8">
		<div class="panel panel-default">
			<div id="show-back-button">
				<%= link_to pins_path do %>
				<span class="glyphicon glyphicon-chevron-left"></span>
				Back
				<% end %>
			</div>

			<div class="panel-heading center">
				<%= get_image(@pin.image.url(:medium)) %>
			</div>

			<div class="panel-body">
				<h4><%= @pin.description %></h4>
				<p><b>Location:</b> <%= @pin.location %></p>
				<p><b>Phone #:</b> <%= @pin.user.phone %></p>
				<p><b>Posted by:</b> <i><%= @pin.user.name if @pin.user %></i></p>
				<p><b>On: </b> <%= @pin.created_at.strftime("%a, %b, %g at %u:%M %P UTC") %> </p>

				<div style='width: 800px;'>
					<div id="map" style='width: 585px; height: 400px;'></div>
				</div>
				<script type="text/javascript">
				handler = Gmaps.build('Google');
				handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
					markers = handler.addMarkers([
					{
						"lat": 43.7,
						"lng": -79.4,
						"picture": {
							"url": "https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png",
							"width":  36,
							"height": 36
						},
						"infowindow": "hello!"
					}
					]);
					handler.bounds.extendWith(markers);
					handler.fitMapToBounds();
				});
				</script>


				<% if @pin.user == current_user %>
				<div class="actions">
					<%= link_to edit_pin_path do %>
					<span class="glyphicon glyphicon-pencil"></span>
					Edit
					<% end %>
					||
					<%= link_to @pin, method: :delete, data: { confirm: 'Are you sure?' } do %>
					<span class="glyphicon glyphicon-remove"></span>
					Cancel
					<% end %>
				</div>
				<% end %>
			</div>
		</div>

	</div>
